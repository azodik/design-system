import { DataTable, Card, CardContent, Button, Pagination } from '@azodik/ui';
import { PropsTable, CodeBlock, CodeBlockWithPreview } from '@/components/docs';
import { useState } from 'react';

export const SelectableDataTableExample = () => {
  const [selectedRowIds, setSelectedRowIds] = useState([]);
  
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  // Convert selectedRowIds back to actual row objects for the DataTable
  const selectedRows = data.filter(row => selectedRowIds.includes(row.id));

  const handleRowSelect = (row, selected) => {
    if (selected) {
      setSelectedRowIds(prev => [...prev, row.id]);
    } else {
      setSelectedRowIds(prev => prev.filter(id => id !== row.id));
    }
  };

  const handleSelectAll = (selected) => {
    if (selected) {
      setSelectedRowIds(data.map(row => row.id));
    } else {
      setSelectedRowIds([]);
    }
  };

  const handleBulkAction = () => {
    console.log('Bulk action on:', selectedRows);
  };

  return (
    <div>
      <div className="mb-4">
        <Button 
          onClick={handleBulkAction}
          disabled={selectedRows.length === 0}
          variant="destructive"
        >
          Delete Selected ({selectedRows.length})
        </Button>
      </div>
      
      <DataTable
        data={data}
        columns={columns}
        selectable
        selectedRows={selectedRows}
        onRowSelect={handleRowSelect}
        onSelectAll={handleSelectAll}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
    </div>
  );
};

export const ActionDataTableExample = () => {
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true },
    { 
      key: 'actions', 
      label: 'Actions',
      render: (row) => (
        <div className="flex gap-sm">
          <Button size="sm" variant="outline" onClick={() => console.log('Edit:', row.id)}>
            Edit
          </Button>
          <Button size="sm" variant="destructive" onClick={() => console.log('Delete:', row.id)}>
            Delete
          </Button>
        </div>
      )
    }
  ];

  return (
    <DataTable
      data={data}
      columns={columns}
      onSort={(key, direction) => console.log('Sort:', key, direction)}
    />
  );
};

export const PaginatedDataTableExample = () => {
  const [currentPage, setCurrentPage] = useState(1);
  const pageSize = 5; // Fixed to 5 entries per page
  
  // Mock data - in real app, this would come from API
  const allData = Array.from({ length: 25 }, (_, i) => ({
    id: i + 1,
    name: 'User ' + (i + 1),
    email: 'user' + (i + 1) + '@example.com',
    role: i % 3 === 0 ? 'Admin' : 'User'
  }));

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  const totalPages = Math.ceil(allData.length / pageSize);
  const startIndex = (currentPage - 1) * pageSize;
  const endIndex = startIndex + pageSize;
  const currentData = allData.slice(startIndex, endIndex);

  const handlePageChange = (page) => {
    setCurrentPage(page);
  };

  return (
    <div>
      <div className="mb-4">
        <span className="text-sm text-gray-600">
          Showing {startIndex + 1}-{Math.min(endIndex, allData.length)} of {allData.length} items
        </span>
      </div>
      
      <DataTable
        data={currentData}
        columns={columns}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
      
      <div className="mt-4 flex justify-center">
        <Pagination
          currentPage={currentPage}
          totalPages={totalPages}
          onPageChange={handlePageChange}
        />
      </div>
    </div>
  );
};

# DataTable Component

The DataTable component provides an advanced table with sorting, selection, and interactive features. It's perfect for displaying complex data with user interactions.

## Introduction

The DataTable component includes several complementary features to handle various data display and interaction scenarios:

- DataTable: the main wrapper for creating advanced tables with interactive functionality and data management.
- DataTable Sorting: built-in column sorting capabilities with visual indicators and direction controls.
- DataTable Selection: row selection functionality with individual and bulk selection support for data operations.
- DataTable Pagination: integrated pagination controls for handling large datasets efficiently.
- DataTable Customization: flexible column rendering, styling, and responsive design options.
- DataTable Accessibility: proper ARIA attributes, keyboard navigation, and screen reader support.

### When to use
- Displaying large datasets with interactive features
- Tables that need sorting and filtering
- Data that requires selection or bulk actions
- Complex data grids with multiple columns
- Administrative interfaces and dashboards


## Usage

<CodeBlock language="tsx">
{`import { DataTable } from '@azodik/ui';`}
</CodeBlock>

## Variants


## Some Example

<CodeBlockWithPreview 
  title="All DataTable Variants"
  preview={
    <div className="flex-vertical">
      <DataTable 
        data={[
          { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
          { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' }
        ]}
        columns={[
          { key: 'name', label: 'Name', sortable: true },
          { key: 'email', label: 'Email', sortable: true },
          { key: 'role', label: 'Role', sortable: true }
        ]}
        onSort={() => {}}
      />
    </div>
  }
>
{`import { DataTable } from '@azodik/ui';

export const DataTableExamples = () => {
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin', status: 'Active' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User', status: 'Inactive' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User', status: 'Active' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true },
    { key: 'status', label: 'Status', sortable: true }
  ];

  return (
    <DataTable
      data={data}
      columns={columns}
      onSort={(key, direction) => console.log('Sort:', key, direction)}
    />
  );
};`}
</CodeBlockWithPreview>

## With Selection

<CodeBlockWithPreview 
  title="DataTable with Selection"
  preview={<SelectableDataTableExample />}
>
{`import { DataTable, Button } from '@azodik/ui';
import { useState } from 'react';

export const SelectableDataTableExample = () => {
  const [selectedRowIds, setSelectedRowIds] = useState([]);
  
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  // Convert selectedRowIds back to actual row objects for the DataTable
  const selectedRows = data.filter(row => selectedRowIds.includes(row.id));

  const handleRowSelect = (row, selected) => {
    if (selected) {
      setSelectedRowIds(prev => [...prev, row.id]);
    } else {
      setSelectedRowIds(prev => prev.filter(id => id !== row.id));
    }
  };

  const handleSelectAll = (selected) => {
    if (selected) {
      setSelectedRowIds(data.map(row => row.id));
    } else {
      setSelectedRowIds([]);
    }
  };

  const handleBulkAction = () => {
    console.log('Bulk action on:', selectedRows);
  };

  return (
    <div>
      <div className="mb-4">
        <Button 
          onClick={handleBulkAction}
          disabled={selectedRows.length === 0}
        >
          Delete Selected ({selectedRows.length})
        </Button>
      </div>
      
      <DataTable
        data={data}
        columns={columns}
        selectable
        selectedRows={selectedRows}
        onRowSelect={handleRowSelect}
        onSelectAll={handleSelectAll}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
    </div>
  );
}`}
</CodeBlockWithPreview>

## With Pagination

<CodeBlockWithPreview 
  title="DataTable with Pagination"
  preview={<PaginatedDataTableExample />}
>
{`import { DataTable, Pagination } from '@azodik/ui';
import { useState } from 'react';

export const PaginatedDataTableExample = () => {
  const [currentPage, setCurrentPage] = useState(1);
  const pageSize = 5; // Fixed to 5 entries per page
  
  // Mock data - in real app, this would come from API
  const allData = Array.from({ length: 25 }, (_, i) => ({
    id: i + 1,
    name: 'User ' + (i + 1),
    email: 'user' + (i + 1) + '@example.com',
    role: i % 3 === 0 ? 'Admin' : 'User'
  }));

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  const totalPages = Math.ceil(allData.length / pageSize);
  const startIndex = (currentPage - 1) * pageSize;
  const endIndex = startIndex + pageSize;
  const currentData = allData.slice(startIndex, endIndex);

  const handlePageChange = (page) => {
    setCurrentPage(page);
  };

  return (
    <div>
      <div className="mb-4">
        <span className="text-sm text-gray-600">
          Showing {startIndex + 1}-{Math.min(endIndex, allData.length)} of {allData.length} items
        </span>
      </div>
      
      <DataTable
        data={currentData}
        columns={columns}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
      
      <div className="mt-4 flex justify-center">
        <Pagination
          currentPage={currentPage}
          totalPages={totalPages}
          onPageChange={handlePageChange}
        />
      </div>
    </div>
  );
}`}
</CodeBlockWithPreview>

## Props

<PropsTable props={[
  {
    name: 'data',
    type: 'T[]',
    required: true,
    default: '-',
    description: 'Array of data objects to display'
  },
  {
    name: 'columns',
    type: 'Array<{ key: keyof T; label: string; sortable?: boolean; render?: (value: any, row: T) => React.ReactNode }>',
    required: true,
    default: '-',
    description: 'Array of column definitions'
  },
  {
    name: 'selectable',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether rows can be selected'
  },
  {
    name: 'selectedRows',
    type: 'T[]',
    required: false,
    default: '[]',
    description: 'Array of selected row data'
  },
  {
    name: 'onRowSelect',
    type: '(row: T, selected: boolean) => void',
    required: false,
    default: '-',
    description: 'Function called when a row is selected/deselected'
  },
  {
    name: 'onSelectAll',
    type: '(selected: boolean) => void',
    required: false,
    default: '-',
    description: 'Function called when select all is toggled'
  },
  {
    name: 'onSort',
    type: '(key: keyof T) => void',
    required: false,
    default: '-',
    description: 'Function called when column is sorted'
  },
  {
    name: 'sortBy',
    type: 'keyof T',
    required: false,
    default: '-',
    description: 'Currently sorted column key'
  },
  {
    name: 'sortDirection',
    type: '"asc" | "desc"',
    required: false,
    default: '-',
    description: 'Current sort direction'
  },
  {
    name: 'onRowClick',
    type: '(row: T) => void',
    required: false,
    default: '-',
    description: 'Function called when a row is clicked'
  },
  {
    name: 'striped',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether to show striped rows'
  },
  {
    name: 'bordered',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether to show table borders'
  },
  {
    name: 'hover',
    type: 'boolean',
    required: false,
    default: 'true',
    description: 'Whether to show hover effects on rows'
  },
  {
    name: 'size',
    type: '"sm" | "md" | "lg"',
    required: false,
    default: '"md"',
    description: 'Size of the table'
  },
  {
    name: 'responsive',
    type: 'boolean',
    required: false,
    default: 'true',
    description: 'Whether to make the table responsive'
  },
  {
    name: 'className',
    type: 'string',
    required: false,
    default: '""',
    description: 'Additional CSS classes to apply'
  }
]} />

## Accessibility

- DataTable has proper semantic structure
- Screen readers can navigate table content
- Keyboard navigation is supported
- Selection states are announced
- Sort controls are accessible

## Design Guidelines

- Use clear and descriptive column headers
- Keep the number of columns reasonable
- Provide clear visual feedback for interactions
- Ensure sufficient contrast for readability
- Consider mobile responsiveness
