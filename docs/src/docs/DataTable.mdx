import { DataTable, Card, CardContent, Button, Pagination } from '@azodik/ui';
import { PropsTable, CodeBlock, CodeBlockWithPreview } from '@/components/docs';
import { useState } from 'react';
import { useLanguageTranslation } from '@/hooks/useLanguageTranslation';

export const DataTableComponentHeader = () => {
  const { t } = useLanguageTranslation();
  return <h1>{t('dataTableComponent')}</h1>;
};

export const DataTableDescription = () => {
  const { t } = useLanguageTranslation();
  return <p>{t('dataTableDescription')}</p>;
};

export const DataTableIntroduction = () => {
  const { t } = useLanguageTranslation();
  return (
    <>
      <h2>{t('dataTableIntroduction')}</h2>
      <p>{t('dataTableIntroDesc')}</p>
      <ul>
        <li>{t('dataTableMainWrapper')}</li>
        <li>{t('dataTableSorting')}</li>
        <li>{t('dataTableSelection')}</li>
        <li>{t('dataTablePagination')}</li>
        <li>{t('dataTableCustomization')}</li>
        <li>{t('dataTableAccessibility')}</li>
      </ul>
    </>
  );
};

export const WhenToUseDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return (
    <>
      <h3>{t('whenToUseDataTable')}</h3>
      <ul>
        <li>{t('displayingLargeDatasetsWithInteractiveFeatures')}</li>
        <li>{t('tablesThatNeedSortingAndFiltering')}</li>
        <li>{t('dataThatRequiresSelectionOrBulkActions')}</li>
        <li>{t('complexDataGridsWithMultipleColumns')}</li>
        <li>{t('administrativeInterfacesAndDashboards')}</li>
      </ul>
    </>
  );
};

export const UsageDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('usageDataTable')}</h2>;
};

export const VariantsDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('variantsDataTable')}</h2>;
};

export const SomeExampleDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('someExampleDataTable')}</h2>;
};

export const AllDataTableVariantsTitle = () => {
  const { t } = useLanguageTranslation();
  return t('allDataTableVariants');
};

export const WithSelectionTitle = () => {
  const { t } = useLanguageTranslation();
  return t('withSelection');
};

export const DataTableWithSelectionTitle = () => {
  const { t } = useLanguageTranslation();
  return t('dataTableWithSelection');
};

export const WithPaginationTitle = () => {
  const { t } = useLanguageTranslation();
  return t('withPagination');
};

export const DataTableWithPaginationTitle = () => {
  const { t } = useLanguageTranslation();
  return t('dataTableWithPagination');
};

export const PropsDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('propsDataTable')}</h2>;
};

export const AccessibilityDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('accessibilityDataTable')}</h2>;
};

export const DesignGuidelinesDataTableSection = () => {
  const { t } = useLanguageTranslation();
  return <h2>{t('designGuidelinesDataTable')}</h2>;
};

export const AccessibilityDataTableList = () => {
  const { t } = useLanguageTranslation();
  return (
    <ul>
      <li>{t('dataTableHasProperSemanticStructure')}</li>
      <li>{t('screenReadersCanNavigateTableContent')}</li>
      <li>{t('keyboardNavigationSupportedDataTable')}</li>
      <li>{t('selectionStatesAreAnnounced')}</li>
      <li>{t('sortControlsAreAccessible')}</li>
    </ul>
  );
};

export const DesignGuidelinesDataTableList = () => {
  const { t } = useLanguageTranslation();
  return (
    <ul>
      <li>{t('useClearAndDescriptiveColumnHeaders')}</li>
      <li>{t('keepTheNumberOfColumnsReasonable')}</li>
      <li>{t('provideClearVisualFeedbackForInteractions')}</li>
      <li>{t('ensureSufficientContrastForReadability')}</li>
      <li>{t('considerMobileResponsiveness')}</li>
    </ul>
  );
};

export const SelectableDataTableExample = () => {
  const [selectedRowIds, setSelectedRowIds] = useState([]);
  
  const data = [
    { id: 1, name: 'John Doe', role: 'Admin' },
    { id: 2, name: 'Jane Smith', role: 'User' },
    { id: 3, name: 'Bob Johnson', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  // Convert selectedRowIds back to actual row objects for the DataTable
  const selectedRows = data.filter(row => selectedRowIds.includes(row.id));

  const handleRowSelect = (row, selected) => {
    if (selected) {
      setSelectedRowIds(prev => [...prev, row.id]);
    } else {
      setSelectedRowIds(prev => prev.filter(id => id !== row.id));
    }
  };

  const handleSelectAll = (selected) => {
    if (selected) {
      setSelectedRowIds(data.map(row => row.id));
    } else {
      setSelectedRowIds([]);
    }
  };

  const handleBulkAction = () => {
    console.log('Bulk action on:', selectedRows);
  };

  return (
    <div style={{ width: '100%', overflow: 'hidden' }}>
      <div className="mb-4">
        <Button 
          onClick={handleBulkAction}
          disabled={selectedRows.length === 0}
          variant="destructive"
        >
          Delete Selected ({selectedRows.length})
        </Button>
      </div>
      
      <div style={{ width: '100%', overflow: 'hidden' }}>
        <DataTable
          data={data}
          columns={columns}
          selectable
          selectedRows={selectedRows}
          onRowSelect={handleRowSelect}
          onSelectAll={handleSelectAll}
          onSort={(key, direction) => console.log('Sort:', key, direction)}
        />
      </div>
    </div>
  );
};

export const ActionDataTableExample = () => {
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true },
    { 
      key: 'actions', 
      label: 'Actions',
      render: (row) => (
        <div className="flex gap-sm">
          <Button size="sm" variant="outline" onClick={() => console.log('Edit:', row.id)}>
            Edit
          </Button>
          <Button size="sm" variant="destructive" onClick={() => console.log('Delete:', row.id)}>
            Delete
          </Button>
        </div>
      )
    }
  ];

  return (
    <div style={{ width: '100%', overflow: 'hidden' }}>
      <DataTable
        data={data}
        columns={columns}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
    </div>
  );
};

export const PaginatedDataTableExample = () => {
  const [currentPage, setCurrentPage] = useState(2);
  const pageSize = 5; // Fixed to 5 entries per page
  
  // Mock data - in real app, this would come from API
  const allData = Array.from({ length: 25 }, (_, i) => ({
    id: i + 1,
    name: 'User ' + (i + 1),
    role: i % 3 === 0 ? 'Admin' : 'User'
  }));

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  const totalPages = Math.ceil(allData.length / pageSize);
  const startIndex = (currentPage - 1) * pageSize;
  const endIndex = startIndex + pageSize;
  const currentData = allData.slice(startIndex, endIndex);

  const handlePageChange = (page) => {
    setCurrentPage(page);
  };

  return (
    <div style={{ width: '100%', overflow: 'hidden' }}>
      <div className="mb-4">
        <span className="text-sm text-gray-600">
          Showing {startIndex + 1}-{Math.min(endIndex, allData.length)} of {allData.length} items
        </span>
      </div>
      
      <div style={{ width: '100%', overflow: 'hidden' }}>
        <DataTable
          data={currentData}
          columns={columns}
          onSort={(key, direction) => console.log('Sort:', key, direction)}
        />
      </div>
      
      <div className="mt-4 flex justify-center">
        <div className="pagination-responsive">
          <Pagination
            currentPage={currentPage}
            totalPages={totalPages}
            onPageChange={handlePageChange}
            maxVisiblePages={3}
          />
        </div>
      </div>
    </div>
  );
};

<DataTableComponentHeader />

<DataTableDescription />

<DataTableIntroduction />

<WhenToUseDataTableSection />

<UsageDataTableSection />

<CodeBlock language="tsx">
{`import { DataTable } from '@azodik/ui';`}
</CodeBlock>

<VariantsDataTableSection />

<SomeExampleDataTableSection />

<CodeBlockWithPreview 
  title={<AllDataTableVariantsTitle />}
  preview={
    <div className="flex-vertical" style={{ width: '100%', overflow: 'hidden' }}>
      <div style={{ width: '100%', overflow: 'hidden' }}>
        <DataTable 
          data={[
            { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin' },
            { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User' }
          ]}
          columns={[
            { key: 'name', label: 'Name', sortable: true },
            { key: 'email', label: 'Email', sortable: true },
            { key: 'role', label: 'Role', sortable: true }
          ]}
          onSort={() => {}}
        />
      </div>
    </div>
  }
>
{`import { DataTable } from '@azodik/ui';

export const DataTableExamples = () => {
  const data = [
    { id: 1, name: 'John Doe', email: 'john@example.com', role: 'Admin', status: 'Active' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'User', status: 'Inactive' },
    { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'User', status: 'Active' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true },
    { key: 'status', label: 'Status', sortable: true }
  ];

  return (
    <DataTable
      data={data}
      columns={columns}
      onSort={(key, direction) => console.log('Sort:', key, direction)}
    />
  );
};`}
</CodeBlockWithPreview>

<WithSelectionTitle />

<CodeBlockWithPreview 
  title={<DataTableWithSelectionTitle />}
  preview={<SelectableDataTableExample />}
>
{`import { DataTable, Button } from '@azodik/ui';
import { useState } from 'react';

export const SelectableDataTableExample = () => {
  const [selectedRowIds, setSelectedRowIds] = useState([]);
  
  const data = [
    { id: 1, name: 'John Doe', role: 'Admin' },
    { id: 2, name: 'Jane Smith', role: 'User' },
    { id: 3, name: 'Bob Johnson', role: 'User' }
  ];

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  // Convert selectedRowIds back to actual row objects for the DataTable
  const selectedRows = data.filter(row => selectedRowIds.includes(row.id));

  const handleRowSelect = (row, selected) => {
    if (selected) {
      setSelectedRowIds(prev => [...prev, row.id]);
    } else {
      setSelectedRowIds(prev => prev.filter(id => id !== row.id));
    }
  };

  const handleSelectAll = (selected) => {
    if (selected) {
      setSelectedRowIds(data.map(row => row.id));
    } else {
      setSelectedRowIds([]);
    }
  };

  const handleBulkAction = () => {
    console.log('Bulk action on:', selectedRows);
  };

  return (
    <div>
      <div className="mb-4">
        <Button 
          onClick={handleBulkAction}
          disabled={selectedRows.length === 0}
        >
          Delete Selected ({selectedRows.length})
        </Button>
      </div>
      
      <DataTable
        data={data}
        columns={columns}
        selectable
        selectedRows={selectedRows}
        onRowSelect={handleRowSelect}
        onSelectAll={handleSelectAll}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
    </div>
  );
}`}
</CodeBlockWithPreview>

<WithPaginationTitle />

<CodeBlockWithPreview 
  title={<DataTableWithPaginationTitle />}
  preview={<PaginatedDataTableExample />}
>
{`import { DataTable, Pagination } from '@azodik/ui';
import { useState } from 'react';

export const PaginatedDataTableExample = () => {
  const [currentPage, setCurrentPage] = useState(2);
  const pageSize = 5; // Fixed to 5 entries per page
  
  // Mock data - in real app, this would come from API
  const allData = Array.from({ length: 25 }, (_, i) => ({
    id: i + 1,
    name: 'User ' + (i + 1),
    role: i % 3 === 0 ? 'Admin' : 'User'
  }));

  const columns = [
    { key: 'name', label: 'Name', sortable: true },
    { key: 'role', label: 'Role', sortable: true }
  ];

  const totalPages = Math.ceil(allData.length / pageSize);
  const startIndex = (currentPage - 1) * pageSize;
  const endIndex = startIndex + pageSize;
  const currentData = allData.slice(startIndex, endIndex);

  const handlePageChange = (page) => {
    setCurrentPage(page);
  };

  return (
    <div>
      <div className="mb-4">
        <span className="text-sm text-gray-600">
          Showing {startIndex + 1}-{Math.min(endIndex, allData.length)} of {allData.length} items
        </span>
      </div>
      
      <DataTable
        data={currentData}
        columns={columns}
        onSort={(key, direction) => console.log('Sort:', key, direction)}
      />
      
      <div className="mt-4 flex justify-center">
        <div className="pagination-responsive">
          <Pagination
            currentPage={currentPage}
            totalPages={totalPages}
            onPageChange={handlePageChange}
            maxVisiblePages={3}
          />
        </div>
      </div>
    </div>
  );
}`}
</CodeBlockWithPreview>

<PropsDataTableSection />

<PropsTable props={[
  {
    name: 'data',
    type: 'T[]',
    required: true,
    default: '-',
    description: 'Array of data objects to display'
  },
  {
    name: 'columns',
    type: 'Array<{ key: keyof T; label: string; sortable?: boolean; render?: (value: any, row: T) => React.ReactNode }>',
    required: true,
    default: '-',
    description: 'Array of column definitions'
  },
  {
    name: 'selectable',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether rows can be selected'
  },
  {
    name: 'selectedRows',
    type: 'T[]',
    required: false,
    default: '[]',
    description: 'Array of selected row data'
  },
  {
    name: 'onRowSelect',
    type: '(row: T, selected: boolean) => void',
    required: false,
    default: '-',
    description: 'Function called when a row is selected/deselected'
  },
  {
    name: 'onSelectAll',
    type: '(selected: boolean) => void',
    required: false,
    default: '-',
    description: 'Function called when select all is toggled'
  },
  {
    name: 'onSort',
    type: '(key: keyof T) => void',
    required: false,
    default: '-',
    description: 'Function called when column is sorted'
  },
  {
    name: 'sortBy',
    type: 'keyof T',
    required: false,
    default: '-',
    description: 'Currently sorted column key'
  },
  {
    name: 'sortDirection',
    type: '"asc" | "desc"',
    required: false,
    default: '-',
    description: 'Current sort direction'
  },
  {
    name: 'onRowClick',
    type: '(row: T) => void',
    required: false,
    default: '-',
    description: 'Function called when a row is clicked'
  },
  {
    name: 'striped',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether to show striped rows'
  },
  {
    name: 'bordered',
    type: 'boolean',
    required: false,
    default: 'false',
    description: 'Whether to show table borders'
  },
  {
    name: 'hover',
    type: 'boolean',
    required: false,
    default: 'true',
    description: 'Whether to show hover effects on rows'
  },
  {
    name: 'size',
    type: '"sm" | "md" | "lg"',
    required: false,
    default: '"md"',
    description: 'Size of the table'
  },
  {
    name: 'responsive',
    type: 'boolean',
    required: false,
    default: 'true',
    description: 'Whether to make the table responsive'
  },
  {
    name: 'className',
    type: 'string',
    required: false,
    default: '""',
    description: 'Additional CSS classes to apply'
  }
]} />

<AccessibilityDataTableSection />

<AccessibilityDataTableList />

<DesignGuidelinesDataTableSection />

<DesignGuidelinesDataTableList />
